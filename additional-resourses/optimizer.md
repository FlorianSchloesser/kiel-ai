# Selecting the Optimizer

The following Blog post by Sebastian Ruder gives you a detailed introduction into the different existing optimizers and their specifics.

{% embed url="https://ruder.io/optimizing-gradient-descent/" %}

The Blog post pasted below was published in [The Batch](https://blog.deeplearning.ai/blog/the-batch-data-for-defense-predicting-credit-approvals-more-learning-from-fewer-labels-hunting-for-planets) on September 9, 2020, and gives you a quick overview of the current most important optimizer and their empirical differences, based on a paper from Robin Schmidt and colleagues from the University of Tübingen.

## **Optimizer Shootout**

![14 most popular optimizers according to arXiv mentions](<../.gitbook/assets/grafik (1) (1).png>)

Everyone has a favorite optimization method, but it’s not always clear which one works best in a given situation. New research aims to establish a set of benchmarks.\
**What’s new:** Robin Schmidt and colleagues at University of Tübingen evaluated [14 popular optimizers](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMlD3p\_8SV1-WJV7Cg-xsN9bgjR2-1xjzW7Z\_dN96gGHSVW2kj6SJ2C-Q5pW36sJnG6MFdpCW1lLJ8m8Mg-ZmW30FrkQ3zfKlSW3z5Gb83\_lChmVC3Kkf6tGjjvN19-9JVgnRYsN1FQXcsyLFCdW5ftV2N2NPdwVW3B2yYc5bbh4pW95TKsf8H48fBW3ZXzXG2rbWzYW2xWw-Q2rPcFFW93N-lC5btqv5W2pd9\_p2sc70CN2Q4Rmt5McDwW2btbl-5yl0j5W2cdl\_t94lqcNW3ryZh67WQ5zFW5DQ2Y75fXKpG3pLK1) using the [Deep Optimization Benchmark Suite](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMlD3p\_8SV1-WJV7CgYQvW34DqYg1TMS0CW3ql6444fXY0CW3\_n4Bx22Wt97W7zp5GL95n8NZVyDczM1VzMhDW5R38yG4MXTpdVZBFGF8bCtXNW674skP6Bn4PZW6N465y5xzDmLVcVV596HHXSMVdM3Sc9hlTCnW5c5dJh5gKnlYW9lW0D14SMBkqVBy5WC7FDdD5W7Tlsg86MmsY3W5l1fFz1mKc4pW6L7jv15Wk7rWW1hvKCs2h8pDHW56Rcgq6T6vwrW5XgmlH4JZFbrN8R2695LtcbmW73q7Pd58f7BN3hQy1) some of them introduced last year.\
**Key insight:** Choosing an optimizer is something of a dark art. Testing the most popular ones in several common tasks is a first step toward setting baselines for comparison.\
**How it works:** The authors evaluated methods including [AMSGrad](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMlX3p\_97V1-WJV7CgBNwN4NWzQ-WnkqjW98HvtZ6c-dbFW8P8cHF4BnxTfN3JGPv-R9PwVW2VlDmL5By9gNVQRNDM3xqCbqW83cgNj407L8vW5dFZl-4p\_46jW1BgW627ZrwS8W3-6TY97zf7r3Vf6CPM2pp4SnW3yVV\_r6pJPRMN2Hq31D4sYgwW46Px5C2vTfW4VVTX3b1xDc8FW10blpR4VccjcW1mtHCX6V317VW2d2mvR4ny9r0W4hb\_fS42TX3SW3ncH4s3YpKHYW8jj51F3Pp5z0W3XcdZx6fLp5YW6kqNll3GYZy9Vdt7vf8RC1\_K35Zv1), [AdaGrad](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMlX3p\_97V1-WJV7CgM4SW7ty9qr3D9bKlMlj85sRtbVZW37TrGC62tpJWW97yk6811WrmrW4BCjjL4ZSLhCVX2yKb2qwGH0W6wBHYt39Mr1JW6spZBZ9dP4hpN5YQzp21jWqvW2T\_L467JsYjvW3SzB0X3cV6DVW5VLBng2TGVBmN2trmPGx08t2N8YQF4yQmXg\_W305ccM1\_t\_VFW1ChlVX2Zjj5kW8f6L4x2tzptwW2TKcNB85vgBcW9fxP6B7-D-8xW6MtHr1186hynW1ny\_5q8sXmKNW7BBd2g5wG2s2W28QpsB2F1vvXW9bW2jj3mvYJ139P\_1), [Adam](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMlD3p\_8SV1-WJV7CgRspW8y3WV92nkHH5W4GGRsq6b48ftW2S7F1L13LPNmTWjQc1bx3gWW7H8dPG3HmK-8N29q8cXyW2T-Myp4yCxktDBW5C\_XBy2vmQ2tW2WFpy42XxLQxN8DrWJFD1CxQW3\_hjpR2XvTrBW66jnt35DggBLW9dmfHR3dCTwHW6\_y\_Xg1GvBFGW4-jyHP5-kGllW2hZy9J6ChfWPN4SQz4PnbwK6W8-gDrR5fYTBFW8rQmFL8rJTpcV6KBW21LDM6SW8KBrSc5Z9-C6W57HwQ25yKn4L3mtk1) (see Andrew’s [video](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMlD3p\_8SV1-WJV7CgCH7V9Q0ft2WZc75W8prmp52WxpJ\_W5SnZmK466b1SW2BsTk\_1McsjqW5RmWyf7WxhMgW4dW82r5k\_FDpW3Ycl4Y1KYRB5W5sRfKN3zCKZPW6xyznG6qHn5MW2v9vQQ37nJ6MW8qJ0CR2BKC7BW68Nffz7pL0LJW558Qry4VcW\_kW3VM1B11Cc1chW7F9kTV6jt8tNW8zFkTB8BySs\_F6xV\_pBX6pWW6vs2cb6jv\_yBW3rhp9s5gLlMlW6KLXGv6RVjdGN82JC5XykVSzW3Mw3Mq8RVDvj33w31) on the topic), [RMSProp](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMmc3p\_9rV1-WJV7CgBKmW66-Z3B8\_9XdzW8NkrQl852hhKW6GSTBh8lDmJJW8tDkjz7Q3kC5W31JQ1h8FQ4tKW6gGtQl944rBFW63TrH\_8m3TpJW7K6t-12sYyjkW47YGX059SkKzW5zK-458DScpqW53F72x77fxfKMq8mrl\_pttKW8LQ64c8mNckpW1xqgS86Q-wk1MKjK0QNwV1XW5TF4117SCJPbW2HF1Zh8vX492N95W-cnbtt80W1rK1Yt2nnVXqW4yfvrd3N3ZTvW6880Ls6W7ThJW7FlpPY4fdvKwW5KSJDJ790w7gN2NG-9QQQgqSW7yhqp51Qt\_JMW8MzW7p7hPPk637fX1) ([video](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMlD3p\_8SV1-WJV7CgNhHW1fFhlV1HpND9W7XsfSX59ShgTW1GnphH5FhVv9W8SYQm610rXFjW2JhSzy3rhwWVW3gF0Bd7sn26pW8JyY0b5V9kVXW4WzFWl5DG\_KCW5\_t2Xn4BDypyV2PP0p19TvLDW1S9-jM2\_BSBjW8Wmqky5ZPljSW5HP8Ng4KM\_cbW1FKmFv7q\_4mfW1Gg0Gh3bdgW0W74SdDK7mXjW0V8xPPW4YJGntW8sxrn64LrJ9XW5zPvfd7pVYPBN1vdY7NhcSwQW6VsH0r3M\_W8pW1kb7jj1WzcR72-r1)), and [stochastic gradient descent](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMlX3p\_97V1-WJV7CgXhPVnTn-K8G7\_QMN7yJxtfKMj7XW1s7wNJ721HFMW55nBnt6RlL1RN6nSvGMFVzG\_W5TkSVY2b\_JLjW3BjY-L511S2YW6MDVfh3PLNVsW1djhF\_1wFkcJW36pqXz8r\_SxnN2hD20WZNjtHW8mZGlR5rs9gzN5nt\_8HdMYFWW3SC6VQ7H-xsVW4bz0Zm2k56ktW6zmp\_75KMtcBW3NCqhC4gw42MN7ph-VFvGpgPW7bRbRB87pB7\_W3rtjH13cFxyCW4QFPt\_61f--hW12WgGp1Kqt6wN5PK\_p0Qv6Y9VZvk2G9ckyct2Jr1). Their selection was based on the number of mentions a given optimizer received in the abstracts of arXiv.org preprints.

* The authors tested each optimization method on eight deep learning problems consisting of a dataset (image or text), standard architecture, and loss function. The problems include both generative and classification tasks.
* They used the initial hyperparameter values proposed by each optimizer’s original authors. They also searched 25 and 50 random values to probe each one’s robustness.
* They applied four different learning rate schedules including constant value, smooth decay, cyclical values, and a trapezoidal method (in which the learning rate increased linearly at the beginning, maintained its value, and decreased linearly at the very end).
* Each experiment was performed using 10 different initializations in case a given initialization degraded performance.

**Results:**No particular method yielded the best performance in all problems, but several popular ones worked well on the majority of problems. (These included Adam, giving weight to the common advice to use it as a default choice.) No particular hyperparameter search or learning rate schedule proved universally superior, but hyperparameter search raised median performance among all optimizers on every task.\
**Why it matters:** Optimizers are so numerous that it’s impossible to compare them all, and differences among models and datasets are bound to introduce confounding variables. Rather than relying on a few personal favorites, machine learning engineers can use this work to get an objective read on the options.\
**We’re thinking:** That’s 14 optimizers down and hundreds to go! The [code](https://info.deeplearning.ai/e2t/tc/VVw5LK7jRbdyN8F-8-Sny3hcVLsY3L4fNPgqN5NMMmc3p\_9rV1-WJV7CgBrkW41YmsK3BcTR-W2ggjgD6kSFH\_W1hw2XD1KsZGkW7X3BmW4RgwxLW2gLz9Y1rXvC4W8\_nJhB1DSTbLW5hrryP7B7shVW5W9z0N2vRRK9W49rg6Q4FyX3XW4jDRLL6H\_0DSW2fN4cr8lgG9VW6qbN1w36lmWNW4bx5Mf3mTjWsML7vMNr1c2QW10\_GPP5fVlkrW1tKKcQ6FMQW4W83ss865l-ZT0W5HHWFM9fRK8qW18c1D-6QNm5lW7ld23G4g3qSYW79yCF773nMphW5B4V1M863wB-W64pDmp6l5cQ8TyD7d1042FyW5zHYMW6\_Ds3rW780qNd24PYpq33Jz1) is open source, so in time we may get to the rest.
